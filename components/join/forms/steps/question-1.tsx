import React from 'react';
import { useFormContext } from 'react-hook-form';
import { useTranslate } from '~/i18n';
import cookie from 'js-cookie';
import { GuestType } from '~/interfaces/guest';

import CustomRadioInput from '~/components/shared/forms/custom-radio-input';
import { QuestionType } from '~/interfaces/question';

/******************************************************************
 *
 *  THIS COMPONENT WAS GENERATED BY NEXTCRAZY-CLI
 *
 ******************************************************************/

type Question1Props = {
   onNextClick: () => any;
   step?: string | undefined;
   showStepSummary?: boolean;
   nextStep?: string;
   question: QuestionType;
};

const Question1 = ({ onNextClick, step, nextStep, question }: Question1Props) => {
   const { translate } = useTranslate();
   const {
      register,
      // handleSubmit,

      formState: { errors },
   } = useFormContext<GuestType>();

   const submitForm = async (value: string) => {
      try {
         const userData = cookie.get('user_data') && JSON.parse(cookie.get('user_data') as any);
         const updatedUserObj = {
            ...userData,
            question_1: value,
            step: nextStep,
         };

         cookie.set('user_data', JSON.stringify(updatedUserObj));
         onNextClick();
      } catch (error: any) {
         console.log(error, 'error');
      }
   };

   return (
      <React.Fragment>
         {step === 'question_1' ? (
            <div>
               <div className="p-1 sm:p-1">
                  <div className="pt-1">
                     <form noValidate className="relative" autoComplete="off">
                        {/* question_1 */}
                        <CustomRadioInput
                           label={translate({ id: 'web:question_1' })}
                           subLabel={question.sub_label}
                           // isRequired
                           isInline={false}
                           callBack={val => submitForm(val)}
                           options={question.options.map(item => {
                              return { label: item, value: item };
                           })}
                           id="question_1"
                           error={errors.question_1?.message}
                           {...register('question_1', {
                              required: translate({ id: 'validation:required' }),
                           })}
                        />
                     </form>
                  </div>
               </div>
            </div>
         ) : (
            ''
         )}
      </React.Fragment>
   );
};

export default Question1;
